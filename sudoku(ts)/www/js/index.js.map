{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"jQuery\"","webpack:///./ts/core/toolkit.ts","webpack:///./ts/index.ts","webpack:///./ts/ui/grid.ts","webpack:///./ts/core/sudoku.ts","webpack:///./ts/core/generator.ts","webpack:///./ts/core/checker.ts","webpack:///./ts/ui/popupnumbers.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","jQuery","boxToolkit","matrix","boxIndex","startRowIndex","Math","floor","startColIndex","result","rowIndex","colIndex","push","cellIndex","matrixToolkit","Array","from","length","makeRow","array","fill","endIndex","j","random","boxCoor","convertToBoxIndex","boxCells","getBoxCells","Toolkit","$container","$popupNumbers","grid","grid_1","require","popupnumbers_1","$","bindPopup","rebuild","on","check","alert","reset","clear","window","layout","sudoku_1","checker_1","Grid","container","this","_$container","make","rowGroupClasses","colGroupClasses","_cells","map","rowValues","cellValue","text","addClass","rows","rowCells","append","empty","width","height","css","popupNumbers","e","$cell","target","hasClass","popup","data","$span","parseInt","checker","success","marks","forEach","removeClass","generator_1","Sudoku","generate","level","puzzleMatrix","row","v","toolkit_1","Generator","internalGenerate","console","warn","orders","x","shuffle","every","fillNumber","number","fillRow","checkFillable","Checker","filter","index","checkRows","checkCols","checkBoxes","_success","_checkArray","cols","box","convertFromBoxIndex","PopupNumbers","$div","_$panel","emptyTarget","markTarget","setTargetValue","hide","_$targetCell","marker","$target","cellPosition","position","left","min","max","BLOCK_WIDTH","top","show"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","module.exports = jQuery;","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// 宫坐标工具箱\r\nclass BoxToolkit {\r\n    // 根据给定的宫号(从0开始)获取一个数组，\r\n    // 这个数组按先行后列从左到右的顺序包含宫内每个元素的值\r\n    getBoxCells(matrix, boxIndex) {\r\n        const startRowIndex = Math.floor(boxIndex / 3) * 3;\r\n        const startColIndex = boxIndex % 3 * 3;\r\n        const result = [];\r\n        for (let i = 0; i < 9; i++) {\r\n            const rowIndex = startRowIndex + Math.floor(i / 3);\r\n            const colIndex = startColIndex + i % 3;\r\n            result.push(matrix[rowIndex][colIndex]);\r\n        }\r\n        return result;\r\n    }\r\n    // 从宫坐标转换为矩阵坐标\r\n    convertFromBoxIndex(boxIndex, cellIndex) {\r\n        return {\r\n            rowIndex: Math.floor(boxIndex / 3) * 3 + Math.floor(cellIndex / 3),\r\n            colIndex: boxIndex % 3 * 3 + cellIndex % 3\r\n        };\r\n    }\r\n    // 从矩阵坐标转换为宫坐标\r\n    convertToBoxIndex(rowIndex, colIndex) {\r\n        return {\r\n            boxIndex: Math.floor(rowIndex / 3) * 3 + Math.floor(colIndex / 3),\r\n            cellIndex: rowIndex % 3 * 3 + colIndex % 3\r\n        };\r\n    }\r\n}\r\n;\r\nconst boxToolkit = new BoxToolkit();\r\n// 矩阵工具箱\r\nclass MatrixToolkit {\r\n    make(value = 0) {\r\n        return Array.from({ length: 9 }, () => this.makeRow(value));\r\n    }\r\n    makeRow(value = 0) {\r\n        const array = new Array(9);\r\n        array.fill(value);\r\n        return array;\r\n    }\r\n    // Fisher-Yates 洗牌算法，Lodash 中有实现\r\n    // 传入一个数组，对数组元素洗牌之后，再将其返回\r\n    shuffle(array) {\r\n        const length = array.length;\r\n        const endIndex = length - 1;\r\n        for (let i = 0; i < endIndex; i++) {\r\n            const j = i + Math.floor(Math.random() * (length - i));\r\n            [array[i], array[j]] = [array[j], array[i]];\r\n        }\r\n        return array;\r\n    }\r\n    // 检查某个位置是否可以填入 n\r\n    checkFillable(matrix, n, rowIndex, colIndex) {\r\n        const boxCoor = boxToolkit.convertToBoxIndex(rowIndex, colIndex);\r\n        const boxCells = boxToolkit.getBoxCells(matrix, boxCoor.boxIndex);\r\n        for (let i = 0; i < 9; i++) {\r\n            if (matrix[i][colIndex] === n\r\n                || matrix[rowIndex][i] === n\r\n                || boxCells[i] === n) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n;\r\nconst matrixToolkit = new MatrixToolkit();\r\nconst Toolkit = {\r\n    get matrix() {\r\n        return matrixToolkit;\r\n    },\r\n    get box() {\r\n        return boxToolkit;\r\n    }\r\n};\r\nexports.default = Toolkit;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst grid_1 = require(\"./ui/grid\");\r\nconst popupnumbers_1 = require(\"./ui/popupnumbers\");\r\nfunction main() {\r\n    const $container = $(\"#container\");\r\n    const $popupNumbers = $(\"#popupNumbers\");\r\n    const grid = new grid_1.default($container);\r\n    grid.bindPopup(new popupnumbers_1.default($popupNumbers));\r\n    grid.rebuild();\r\n    $(\"#check\").on(\"click\", () => {\r\n        if (grid.check()) {\r\n            alert(\"成功\");\r\n        }\r\n    });\r\n    $(\"#reset\").on(\"click\", () => grid.reset());\r\n    $(\"#clear\").on(\"click\", () => grid.clear());\r\n    $(\"#rebuild\").on(\"click\", () => grid.rebuild());\r\n    $(window).on(\"resize\", () => grid.layout());\r\n}\r\nmain();\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst sudoku_1 = require(\"../core/sudoku\");\r\nconst checker_1 = require(\"../core/checker\");\r\nclass Grid {\r\n    constructor(container) {\r\n        this._$container = container;\r\n    }\r\n    rebuild() {\r\n        const sudoku = new sudoku_1.default();\r\n        const matrix = sudoku.make();\r\n        const rowGroupClasses = [\"row_g_top\", \"row_g_middle\", \"row_g_bottom\"];\r\n        const colGroupClasses = [\"col_g_left\", \"col_g_center\", \"col_g_right\"];\r\n        // 创建矩阵数组对应的 span 二维数组\r\n        this._cells = matrix.map(rowValues => rowValues.map((cellValue, colIndex) => {\r\n            return $(\"<span>\")\r\n                .text(cellValue)\r\n                .addClass(cellValue ? \"fixed\" : \"empty\")\r\n                .addClass(colGroupClasses[colIndex % 3]);\r\n        }));\r\n        // 创建 DOM\r\n        const rows = this._cells.map((rowCells, rowIndex) => {\r\n            return $(\"<div>\")\r\n                .addClass(\"row\")\r\n                .addClass(rowGroupClasses[rowIndex % 3])\r\n                .append(rowCells);\r\n        });\r\n        this._$container.empty().append(rows);\r\n        this.layout();\r\n    }\r\n    layout() {\r\n        const width = $(\"span:first\", this._$container).width();\r\n        $(\"span\", this._$container)\r\n            .height(width)\r\n            .css({\r\n            \"line-height\": `${width}px`,\r\n            \"font-size\": width < 32 ? `${width / 2}px` : \"\"\r\n        });\r\n    }\r\n    bindPopup(popupNumbers) {\r\n        this._$container.on(\"click\", \"span\", e => {\r\n            const $cell = $(e.target);\r\n            if ($cell.hasClass(\"fixed\")) {\r\n                return;\r\n            }\r\n            popupNumbers.popup($cell);\r\n        });\r\n    }\r\n    check() {\r\n        const data = this._cells\r\n            .map(rowCells => rowCells\r\n            .map($span => parseInt($span.text(), 10)));\r\n        const checker = new checker_1.default(data).check();\r\n        if (checker.success) {\r\n            return true;\r\n        }\r\n        const marks = checker.marks;\r\n        this._cells.forEach((rowCells, rowIndex) => rowCells.forEach(($span, colIndex) => {\r\n            // 所有预置的数字都不标记\r\n            if ($span.hasClass(\"fixed\")) {\r\n                return;\r\n            }\r\n            if (marks[rowIndex][colIndex]) {\r\n                $span.removeClass(\"error\");\r\n            }\r\n            else {\r\n                $span.addClass(\"error\");\r\n            }\r\n        }));\r\n        return false;\r\n    }\r\n    reset() {\r\n        $(\"span:not(.fixed)\", this._$container)\r\n            .text(\"0\")\r\n            .removeClass(\"mark1 mark2 error\")\r\n            .addClass(\"empty\");\r\n    }\r\n    clear() {\r\n        $(\"span.error\", this._$container).removeClass(\"error\");\r\n    }\r\n}\r\nexports.default = Grid;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst generator_1 = require(\"./generator\");\r\nclass Sudoku {\r\n    constructor() {\r\n        this.matrix = new generator_1.default().generate();\r\n    }\r\n    make(level = 5) {\r\n        this.puzzleMatrix = this.matrix.map(row => {\r\n            return row.map(v => Math.random() * 9 < level ? 0 : v);\r\n        });\r\n        return this.puzzleMatrix;\r\n    }\r\n}\r\nexports.default = Sudoku;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst toolkit_1 = require(\"./toolkit\");\r\nclass Generator {\r\n    generate() {\r\n        while (!this.internalGenerate()) {\r\n            console.warn(\"rebuild\");\r\n        }\r\n        return this.matrix;\r\n    }\r\n    internalGenerate() {\r\n        this.matrix = toolkit_1.default.matrix.make();\r\n        this.orders = Array.from({ length: 9 })\r\n            .map(() => Array.from({ length: 9 }, (x, i) => i))\r\n            .map(row => toolkit_1.default.matrix.shuffle(row));\r\n        return Array.from({ length: 9 })\r\n            .every((n, i) => this.fillNumber(i + 1));\r\n    }\r\n    fillNumber(number) {\r\n        return this.fillRow(number, 0);\r\n    }\r\n    fillRow(n, rowIndex) {\r\n        if (rowIndex >= 9) {\r\n            return true;\r\n        }\r\n        const row = this.matrix[rowIndex];\r\n        const orders = this.orders[rowIndex];\r\n        for (let i = 0; i < orders.length; i++) {\r\n            const colIndex = orders[i];\r\n            // 如果这个位置已经有值，跳过\r\n            if (row[colIndex]) {\r\n                continue;\r\n            }\r\n            // 检查这个位置是否可以填入 n，如果不能填，忽略\r\n            if (!toolkit_1.default.matrix.checkFillable(this.matrix, n, rowIndex, colIndex)) {\r\n                continue;\r\n            }\r\n            row[colIndex] = n;\r\n            // 去下一行填 n，如果没填进去，就回退\r\n            if (!this.fillRow(n, rowIndex + 1)) {\r\n                row[colIndex] = 0;\r\n                continue;\r\n            }\r\n            return true;\r\n        }\r\n        // 所有单元格都填不进去，只好返回失败\r\n        return false;\r\n    }\r\n}\r\nexports.default = Generator;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst toolkit_1 = require(\"./toolkit\");\r\nclass Checker {\r\n    constructor(matrix) {\r\n        this.matrix = matrix;\r\n    }\r\n    static _checkArray(array) {\r\n        const marks = new Array(array.length);\r\n        marks.fill(true);\r\n        array.forEach((v, i) => {\r\n            if (!v) {\r\n                marks[i] = false;\r\n                return;\r\n            }\r\n            if (marks[i]) {\r\n                for (let j = i + 1; j < 9; j++) {\r\n                    if (v === array[j]) {\r\n                        marks[i] = false;\r\n                        marks[j] = false;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return marks\r\n            .map((v, i) => v ? -1 : i)\r\n            .filter(index => index >= 0);\r\n    }\r\n    check() {\r\n        this.marks = toolkit_1.default.matrix.make(true);\r\n        this.checkRows();\r\n        this.checkCols();\r\n        this.checkBoxes();\r\n        this._success = this.marks.every(row => row.every(v => v));\r\n        return this;\r\n    }\r\n    get success() {\r\n        return this._success;\r\n    }\r\n    checkRows() {\r\n        const marks = this.marks;\r\n        this.matrix.forEach((row, rowIndex) => {\r\n            const rowMarks = Checker._checkArray(row);\r\n            rowMarks.forEach(colIndex => {\r\n                marks[rowIndex][colIndex] = false;\r\n            });\r\n        });\r\n    }\r\n    checkCols() {\r\n        const { matrix, marks } = this;\r\n        for (let colIndex = 0; colIndex < 9; colIndex++) {\r\n            const cols = Array.from({ length: 9 })\r\n                .map((v, i) => matrix[i][colIndex]);\r\n            const colMarks = Checker._checkArray(cols);\r\n            colMarks.forEach(rowIndex => marks[rowIndex][colIndex] = false);\r\n        }\r\n    }\r\n    checkBoxes() {\r\n        const { matrix, marks } = this;\r\n        const boxes = Array.from({ length: 9 })\r\n            .map((v, i) => toolkit_1.default.box.getBoxCells(matrix, i));\r\n        boxes.forEach((box, boxIndex) => {\r\n            const boxMarks = Checker._checkArray(box);\r\n            boxMarks.forEach(cellIndex => {\r\n                const { rowIndex, colIndex } = toolkit_1.default.box.convertFromBoxIndex(boxIndex, cellIndex);\r\n                marks[rowIndex][colIndex] = false;\r\n            });\r\n        });\r\n    }\r\n}\r\nexports.default = Checker;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst BLOCK_WIDTH = 48; // 这是在样式表中固定的大小\r\nconst OFFSET = BLOCK_WIDTH + 2;\r\nconst POPUP_WIDTH = BLOCK_WIDTH * 3 + 10;\r\nclass PopupNumbers {\r\n    constructor($div) {\r\n        this._$panel = $div;\r\n        this._$panel\r\n            .on(\"click\", \"span\", e => {\r\n            const $cell = $(e.target);\r\n            if ($cell.hasClass(\"empty\")) {\r\n                this.emptyTarget();\r\n            }\r\n            else if ($cell.hasClass(\"mark\")) {\r\n                this.markTarget($cell.data(\"mark\"));\r\n            }\r\n            else {\r\n                this.setTargetValue($cell.text());\r\n            }\r\n            this._$panel.hide();\r\n            this._$targetCell = null;\r\n        })\r\n            .hide()\r\n            .removeClass(\"hidden\");\r\n    }\r\n    emptyTarget() {\r\n        this._$targetCell\r\n            .text(\"0\")\r\n            .removeClass(\"mark1 mark2 error\")\r\n            .addClass(\"empty\");\r\n    }\r\n    markTarget(marker) {\r\n        const $target = this._$targetCell;\r\n        if ($target.hasClass(marker)) {\r\n            $target.removeClass(\"mark1 mark2 error\");\r\n        }\r\n        else {\r\n            $target.removeClass(\"mark1 mark2 error\").addClass(marker);\r\n        }\r\n    }\r\n    setTargetValue(value) {\r\n        this._$targetCell\r\n            .text(value)\r\n            .removeClass(\"empty error\");\r\n    }\r\n    /**\r\n     * 基于 $cell 指定的方格弹出数字面板，选择的数字将回填到 $cell\r\n     */\r\n    popup($cell) {\r\n        this._$targetCell = $cell;\r\n        const cellPosition = $cell.position();\r\n        const left = Math.min(Math.max(cellPosition.left - OFFSET, 0), $(window).width() - POPUP_WIDTH);\r\n        const top = Math.max(cellPosition.top - OFFSET, 0);\r\n        this._$panel\r\n            .css({\r\n            left: `${left}px`,\r\n            top: `${top}px`\r\n        })\r\n            .show();\r\n    }\r\n}\r\nexports.default = PopupNumbers;\r\n"],"sourceRoot":""}